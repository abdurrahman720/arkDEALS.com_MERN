{"ast":null,"code":"import _regeneratorRuntime from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useQuery}from'@tanstack/react-query';import axios from'axios';import React,{useEffect,useState}from'react';import{toast}from'react-toastify';import AllsellerTable from'../../../Components/AllsellerTable';import ConfirmationModal from'../../../Components/ConfirmationModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Allselller=function Allselller(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),deletingSeller=_useState2[0],setDeletingSeller=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),ads=_useState4[0],setAds=_useState4[1];var _useQuery=useQuery({queryKey:['sellers'],queryFn:function(){var _queryFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:5001/allsellers\",{headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}},_callee);}));function queryFn(){return _queryFn.apply(this,arguments);}return queryFn;}()}),_useQuery$data=_useQuery.data,sellers=_useQuery$data===void 0?[]:_useQuery$data,refetch=_useQuery.refetch;var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"http://localhost:5001/get-advertisement-sort\");case 2:res=_context2.sent;data=res.data;setAds(data);case 5:case\"end\":return _context2.stop();}},_callee2);}));return function fetchData(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchData();},[]);var confirmationModal=function confirmationModal(user){setDeletingSeller(user);console.log(user);};var hadnleVerify=function hadnleVerify(user){console.log(user);if(ads.length>=1){fetch(\"http://localhost:5001/verify-ad/\".concat(user===null||user===void 0?void 0:user.email),{method:'PATCH',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);});}fetch(\"http://localhost:5001/verify-seller/\".concat(user===null||user===void 0?void 0:user._id),{method:'PATCH',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();fetch(\"http://localhost:5001/verify-product/\".concat(user===null||user===void 0?void 0:user.email),{method:'PATCH'}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();if(user.verified===false){toast.success(\"Verified\");}if(user.verified===true){toast.warning(\"Unverified\");}});}).catch(function(err){console.log(err);});};var handleDelete=function handleDelete(user){console.log(user);fetch(\"http://localhost:5001/user-product-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"http://localhost:5001/ad-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE'}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"http://localhost:5001/orders-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE'}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"http://localhost:5001/user-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();toast.success(\"User has been deleted successfully\");toast.warn(\"Don't forget to delete this user from Firebase!\");});});});});};var closeModal=function closeModal(){setDeletingSeller(null);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-base-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-xl\",children:\"All Seller\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto w-full\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table w-full \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"Seller Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:sellers.map(function(seller,i){return/*#__PURE__*/_jsx(AllsellerTable,{seller:seller,confirmationModal:confirmationModal,i:i,hadnleVerify:hadnleVerify},seller._id);})})]})})]}),deletingSeller&&/*#__PURE__*/_jsx(ConfirmationModal,{title:\"Your are deleting \".concat(deletingSeller.name),message:\"Everything associated with this \".concat(deletingSeller.name,\" including products,orders,advertisements will be deleted from database. \\n          Since your are using firebase authentication, you must delete \").concat(deletingSeller.email,\" from there manually!\"),successAction:handleDelete,successButtonName:\"Delete\",modalData:deletingSeller,closeModal:closeModal})]});};export default Allselller;","map":{"version":3,"names":["useQuery","axios","React","useEffect","useState","toast","AllsellerTable","ConfirmationModal","Allselller","deletingSeller","setDeletingSeller","ads","setAds","queryKey","queryFn","fetch","headers","authorization","localStorage","getItem","res","json","data","sellers","refetch","fetchData","get","confirmationModal","user","console","log","hadnleVerify","length","email","method","then","_id","verified","success","warning","catch","err","handleDelete","warn","closeModal","map","seller","i","name"],"sources":["/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/src/Pages/Dashboard/Admin/Allselller.jsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\nimport axios from 'axios';\nimport React, { useEffect, useState } from 'react';\nimport { toast } from 'react-toastify';\nimport AllsellerTable from '../../../Components/AllsellerTable';\nimport ConfirmationModal from '../../../Components/ConfirmationModal';\n\nconst Allselller = () => {\n    const [deletingSeller, setDeletingSeller] = useState(null);\n    const [ads,setAds] = useState([])\n    const { data: sellers = [], refetch } = useQuery({\n        queryKey: ['sellers'],\n        queryFn: async () => {\n            const res = await fetch(`http://localhost:5001/allsellers`, {\n                headers: {\n                    authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n                }\n            })\n            const data = await res.json()\n            return data;\n        }\n    })\n\n    const fetchData = async() => {\n        const res = await axios.get(`http://localhost:5001/get-advertisement-sort`)\n        const data = res.data;\n       setAds(data)\n           \n      }\n      useEffect(() => {\n        fetchData()\n        },[])\n\n    const confirmationModal = (user) => {\n        setDeletingSeller(user)\n    console.log(user);\n    }\n\n    const hadnleVerify = (user) => {\n        console.log(user);\n        if (ads.length >= 1) {\n            fetch(`http://localhost:5001/verify-ad/${user?.email}`, {\n                method: 'PATCH',\n                headers: {\n                    authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n                }\n            })\n                .then(res => res.json())\n                .then(data => {\n                console.log(data);\n            })\n        }\n\n        fetch(`http://localhost:5001/verify-seller/${user?._id}`, {\n            method: 'PATCH',\n            headers: {\n                authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                console.log(data)\n                refetch()\n                fetch(`http://localhost:5001/verify-product/${user?.email}`, {\n                    method: 'PATCH'\n                })\n                    .then(res => res.json())\n                    .then(data => {\n                        console.log(data);\n                        refetch();\n                        if (user.verified === false) {\n                            toast.success(\"Verified\")\n                        }\n                        if (user.verified === true) {\n                           toast.warning(\"Unverified\")\n                       }\n                    })\n                \n            })\n            .catch(err => {\n            console.log(err)\n        })\n        \n        \n       \n\n        \n    }\n\n    const handleDelete = (user) => {\n        console.log(user);\n        fetch(`http://localhost:5001/user-product-delete/${user?.email}`, {\n            method: 'DELETE',\n            headers: {\n                authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                console.log(data)\n                fetch(`http://localhost:5001/ad-delete/${user?.email}`, {\n                    method: 'DELETE',\n                })\n                    .then(res => res.json())\n                    .then(data => {\n                        console.log(data)\n                        fetch(`http://localhost:5001/orders-delete/${user?.email}`, {\n                            method: 'DELETE',\n                        })\n                            .then(res => res.json())\n                            .then(data => {\n                                console.log(data)\n                                fetch(`http://localhost:5001/user-delete/${user?.email}`, {\n                                    method: 'DELETE',\n                                    headers: {\n                                        authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n                                    }\n                                })\n                                    .then(res => res.json())\n                                    .then(data => {\n                                        console.log(data)\n                                        refetch();\n                                        toast.success(\"User has been deleted successfully\");\n                                        toast.warn(\"Don't forget to delete this user from Firebase!\")\n                                        \n                                })\n                        })\n                })\n        })\n    }\n    \n    const closeModal = () => {\n        setDeletingSeller(null)\n    }\n\n    return (\n        <div>\n      <div className=\"bg-base-100\">\n        <h2 className=\"text-center text-xl\">All Seller</h2>\n        <div className=\"overflow-x-auto w-full\">\n          <table className=\"table w-full \">\n            <thead>\n              <tr>\n                <th></th>\n                <th>Seller Name</th>\n                <th>Email</th>\n                <th>Status</th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n            {sellers.map((seller,i) =><AllsellerTable key={seller._id} seller={seller} confirmationModal={confirmationModal} i={i} hadnleVerify={hadnleVerify}></AllsellerTable>)}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      {deletingSeller && (\n        <ConfirmationModal\n          title={`Your are deleting ${deletingSeller.name}`}\n                    message={`Everything associated with this ${deletingSeller.name} including products,orders,advertisements will be deleted from database. \n          Since your are using firebase authentication, you must delete ${deletingSeller.email} from there manually!`}\n          successAction={handleDelete}\n          successButtonName=\"Delete\"\n          modalData={deletingSeller}\n          closeModal={closeModal}\n        ></ConfirmationModal>\n      )}\n    </div>\n    );\n};\n\nexport default Allselller;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}