{"ast":null,"code":"import _regeneratorRuntime from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useQuery}from\"@tanstack/react-query\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import{toast}from\"react-toastify\";import AllsellerTable from\"../../../Components/AllsellerTable\";import ConfirmationModal from\"../../../Components/ConfirmationModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Allselller=function Allselller(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),deletingSeller=_useState2[0],setDeletingSeller=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),ads=_useState4[0],setAds=_useState4[1];var _useQuery=useQuery({queryKey:[\"sellers\"],queryFn:function(){var _queryFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://ark-deals-server.vercel.app/allsellers\",{headers:{authorization:\"Bearer \".concat(localStorage.getItem(\"arkDeals\"))}});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}},_callee);}));function queryFn(){return _queryFn.apply(this,arguments);}return queryFn;}()}),_useQuery$data=_useQuery.data,sellers=_useQuery$data===void 0?[]:_useQuery$data,refetch=_useQuery.refetch;var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"https://ark-deals-server.vercel.app/get-advertisement-sort\");case 2:res=_context2.sent;data=res.data;setAds(data);case 5:case\"end\":return _context2.stop();}},_callee2);}));return function fetchData(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchData();},[]);var confirmationModal=function confirmationModal(user){setDeletingSeller(user);console.log(user);};var hadnleVerify=function hadnleVerify(user){console.log(user);if(ads.length>=1){fetch(\"https://ark-deals-server.vercel.app/verify-ad/\".concat(user===null||user===void 0?void 0:user.email),{method:\"PATCH\",headers:{authorization:\"Bearer \".concat(localStorage.getItem(\"arkDeals\"))}}).then(function(res){return res.json();}).then(function(data){console.log(data);});}fetch(\"https://ark-deals-server.vercel.app/verify-seller/\".concat(user===null||user===void 0?void 0:user._id),{method:\"PATCH\",headers:{authorization:\"Bearer \".concat(localStorage.getItem(\"arkDeals\"))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();fetch(\"https://ark-deals-server.vercel.app/verify-product/\".concat(user===null||user===void 0?void 0:user.email),{method:\"PATCH\"}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();if(user.verified===false){toast.success(\"Verified\");}if(user.verified===true){toast.warning(\"Unverified\");}});}).catch(function(err){console.log(err);});};var handleDelete=function handleDelete(user){console.log(user);fetch(\"https://ark-deals-server.vercel.app/user-product-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:\"DELETE\",headers:{authorization:\"Bearer \".concat(localStorage.getItem(\"arkDeals\"))}}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"https://ark-deals-server.vercel.app/ad-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:\"DELETE\"}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"https://ark-deals-server.vercel.app/orders-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:\"DELETE\"}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"https://ark-deals-server.vercel.app/user-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:\"DELETE\",headers:{authorization:\"Bearer \".concat(localStorage.getItem(\"arkDeals\"))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();toast.success(\"User has been deleted successfully\");toast.warn(\"Don't forget to delete this user from Firebase!\");});});});});};var closeModal=function closeModal(){setDeletingSeller(null);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-base-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-xl\",children:\"All Seller\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto w-full\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table w-full \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"Seller Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:sellers.map(function(seller,i){return/*#__PURE__*/_jsx(AllsellerTable,{seller:seller,confirmationModal:confirmationModal,i:i,hadnleVerify:hadnleVerify},seller._id);})})]})})]}),deletingSeller&&/*#__PURE__*/_jsx(ConfirmationModal,{title:\"Your are deleting \".concat(deletingSeller.name),message:\"Everything associated with this \".concat(deletingSeller.name,\" including products,orders,advertisements will be deleted from database. \\n          Since your are using firebase authentication, you must delete \").concat(deletingSeller.email,\" from there manually!\"),successAction:handleDelete,successButtonName:\"Delete\",modalData:deletingSeller,closeModal:closeModal})]});};export default Allselller;","map":{"version":3,"names":["useQuery","axios","React","useEffect","useState","toast","AllsellerTable","ConfirmationModal","Allselller","deletingSeller","setDeletingSeller","ads","setAds","queryKey","queryFn","fetch","headers","authorization","localStorage","getItem","res","json","data","sellers","refetch","fetchData","get","confirmationModal","user","console","log","hadnleVerify","length","email","method","then","_id","verified","success","warning","catch","err","handleDelete","warn","closeModal","map","seller","i","name"],"sources":["/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/src/Pages/Dashboard/Admin/Allselller.jsx"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport AllsellerTable from \"../../../Components/AllsellerTable\";\nimport ConfirmationModal from \"../../../Components/ConfirmationModal\";\n\nconst Allselller = () => {\n  const [deletingSeller, setDeletingSeller] = useState(null);\n  const [ads, setAds] = useState([]);\n  const { data: sellers = [], refetch } = useQuery({\n    queryKey: [\"sellers\"],\n    queryFn: async () => {\n      const res = await fetch(\n        `https://ark-deals-server.vercel.app/allsellers`,\n        {\n          headers: {\n            authorization: `Bearer ${localStorage.getItem(\"arkDeals\")}`,\n          },\n        }\n      );\n      const data = await res.json();\n      return data;\n    },\n  });\n\n  const fetchData = async () => {\n    const res = await axios.get(\n      `https://ark-deals-server.vercel.app/get-advertisement-sort`\n    );\n    const data = res.data;\n    setAds(data);\n  };\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const confirmationModal = (user) => {\n    setDeletingSeller(user);\n    console.log(user);\n  };\n\n  const hadnleVerify = (user) => {\n    console.log(user);\n    if (ads.length >= 1) {\n      fetch(`https://ark-deals-server.vercel.app/verify-ad/${user?.email}`, {\n        method: \"PATCH\",\n        headers: {\n          authorization: `Bearer ${localStorage.getItem(\"arkDeals\")}`,\n        },\n      })\n        .then((res) => res.json())\n        .then((data) => {\n          console.log(data);\n        });\n    }\n\n    fetch(`https://ark-deals-server.vercel.app/verify-seller/${user?._id}`, {\n      method: \"PATCH\",\n      headers: {\n        authorization: `Bearer ${localStorage.getItem(\"arkDeals\")}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        refetch();\n        fetch(\n          `https://ark-deals-server.vercel.app/verify-product/${user?.email}`,\n          {\n            method: \"PATCH\",\n          }\n        )\n          .then((res) => res.json())\n          .then((data) => {\n            console.log(data);\n            refetch();\n            if (user.verified === false) {\n              toast.success(\"Verified\");\n            }\n            if (user.verified === true) {\n              toast.warning(\"Unverified\");\n            }\n          });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const handleDelete = (user) => {\n    console.log(user);\n    fetch(\n      `https://ark-deals-server.vercel.app/user-product-delete/${user?.email}`,\n      {\n        method: \"DELETE\",\n        headers: {\n          authorization: `Bearer ${localStorage.getItem(\"arkDeals\")}`,\n        },\n      }\n    )\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        fetch(`https://ark-deals-server.vercel.app/ad-delete/${user?.email}`, {\n          method: \"DELETE\",\n        })\n          .then((res) => res.json())\n          .then((data) => {\n            console.log(data);\n            fetch(\n              `https://ark-deals-server.vercel.app/orders-delete/${user?.email}`,\n              {\n                method: \"DELETE\",\n              }\n            )\n              .then((res) => res.json())\n              .then((data) => {\n                console.log(data);\n                fetch(\n                  `https://ark-deals-server.vercel.app/user-delete/${user?.email}`,\n                  {\n                    method: \"DELETE\",\n                    headers: {\n                      authorization: `Bearer ${localStorage.getItem(\n                        \"arkDeals\"\n                      )}`,\n                    },\n                  }\n                )\n                  .then((res) => res.json())\n                  .then((data) => {\n                    console.log(data);\n                    refetch();\n                    toast.success(\"User has been deleted successfully\");\n                    toast.warn(\n                      \"Don't forget to delete this user from Firebase!\"\n                    );\n                  });\n              });\n          });\n      });\n  };\n\n  const closeModal = () => {\n    setDeletingSeller(null);\n  };\n\n  return (\n    <div>\n      <div className=\"bg-base-100\">\n        <h2 className=\"text-center text-xl\">All Seller</h2>\n        <div className=\"overflow-x-auto w-full\">\n          <table className=\"table w-full \">\n            <thead>\n              <tr>\n                <th></th>\n                <th>Seller Name</th>\n                <th>Email</th>\n                <th>Status</th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              {sellers.map((seller, i) => (\n                <AllsellerTable\n                  key={seller._id}\n                  seller={seller}\n                  confirmationModal={confirmationModal}\n                  i={i}\n                  hadnleVerify={hadnleVerify}\n                ></AllsellerTable>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      {deletingSeller && (\n        <ConfirmationModal\n          title={`Your are deleting ${deletingSeller.name}`}\n          message={`Everything associated with this ${deletingSeller.name} including products,orders,advertisements will be deleted from database. \n          Since your are using firebase authentication, you must delete ${deletingSeller.email} from there manually!`}\n          successAction={handleDelete}\n          successButtonName=\"Delete\"\n          modalData={deletingSeller}\n          closeModal={closeModal}\n        ></ConfirmationModal>\n      )}\n    </div>\n  );\n};\n\nexport default Allselller;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}