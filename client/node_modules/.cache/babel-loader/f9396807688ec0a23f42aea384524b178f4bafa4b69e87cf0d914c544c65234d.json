{"ast":null,"code":"import _objectSpread from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from\"react\";import{useForm}from\"react-hook-form\";import{Link,useLocation,useNavigate}from\"react-router-dom\";import{toast}from\"react-toastify\";import{AuthContext}from\"../../Context/AuthProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _location$state,_location$state$from,_errors$email,_errors$password;var navigate=useNavigate();var _useContext=useContext(AuthContext),emailSignIn=_useContext.emailSignIn,googleSign=_useContext.googleSign,isLoading=_useContext.isLoading;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var location=useLocation();var from=(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||\"/\";var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),loginError=_useState2[0],setLoginError=_useState2[1];var handleLogin=function handleLogin(data){setLoginError(\"\");console.log(data);emailSignIn(data.email,data.password).then(function(userCredentials){var user=userCredentials.user;console.log(user);//jwt token\nfetch(\"https://ark-deals-server.vercel.app/jwt?email=\".concat(user===null||user===void 0?void 0:user.email)).then(function(res){return res.json();}).then(function(data){console.log(data.accessToken);localStorage.setItem(\"arkDeals\",data.accessToken);toast.success(\"Login SuccessFully!\");navigate(from,{replace:true});});}).catch(function(err){setLoginError(err.message);isLoading(false);});};var handleGoogleSign=function handleGoogleSign(){googleSign().then(function(res){var signedUser=res.user;console.log(signedUser);var user={name:signedUser.displayName,email:signedUser.email,role:\"buyer\"};fetch(\"https://ark-deals-server.vercel.app/add-users\",{method:\"POST\",headers:{\"content-type\":\"application/json\"},body:JSON.stringify(user)}).then(function(res){return res.json();}).then(function(data){if(data.acknowledged){//jwt token\nfetch(\"https://ark-deals-server.vercel.app/jwt?email=\".concat(user===null||user===void 0?void 0:user.email)).then(function(res){return res.json();}).then(function(data){console.log(data.accessToken);localStorage.setItem(\"arkDeals\",data.accessToken);toast.success(\"Registration Success as Buyer!\");navigate(\"/\");});}});}).catch(function(err){setLoginError(err.message);isLoading(false);});};return/*#__PURE__*/_jsx(\"div\",{className:\"hero min-h-screen bg-base-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"hero-content flex-col lg:flex-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center lg:text-left\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-bold\",children:\"Login now!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"py-6\",children:\"Get the best deals for your preferred laptop with the best price\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(handleLogin),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl text-center\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full max-w-xs\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"label\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Email\"})]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\"},register(\"email\",{required:\"Email Address is required\"})),{},{className:\"input input-bordered w-full max-w-xs\"})),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600\",children:(_errors$email=errors.email)===null||_errors$email===void 0?void 0:_errors$email.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full max-w-xs\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"label\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Password\"})]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"password\"},register(\"password\",{required:\"Password is required\",minLength:{value:6,message:\"Password must be 6 characters or longer\"}})),{},{className:\"input input-bordered w-full max-w-xs\"})),/*#__PURE__*/_jsxs(\"label\",{className:\"label\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Forget Password?\"})]}),errors.password&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600\",children:(_errors$password=errors.password)===null||_errors$password===void 0?void 0:_errors$password.message})]}),/*#__PURE__*/_jsx(\"input\",{className:\"btn btn-accent w-full\",value:\"Login\",type:\"submit\"}),/*#__PURE__*/_jsx(\"div\",{children:loginError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600\",children:loginError})})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[\"New to arkDEALS.com?\",\" \",/*#__PURE__*/_jsx(Link,{className:\"text-secondary\",to:\"/register\",children:\"Register as Buyer\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"divider\",children:\"OR\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGoogleSign,className:\"btn btn-outline btn-secondary w-full\",children:\"CONTINUE WITH GOOGLE\"})]})})]})});};export default Login;","map":{"version":3,"names":["React","useContext","useState","useForm","Link","useLocation","useNavigate","toast","AuthContext","Login","navigate","emailSignIn","googleSign","isLoading","register","handleSubmit","errors","formState","location","from","state","pathname","loginError","setLoginError","handleLogin","data","console","log","email","password","then","userCredentials","user","fetch","res","json","accessToken","localStorage","setItem","success","replace","catch","err","message","handleGoogleSign","signedUser","name","displayName","role","method","headers","body","JSON","stringify","acknowledged","required","minLength","value"],"sources":["/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/src/Pages/AuthPages/Login.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { AuthContext } from \"../../Context/AuthProvider\";\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const { emailSignIn, googleSign, isLoading } = useContext(AuthContext);\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm();\n\n  const location = useLocation();\n  const from = location?.state?.from?.pathname || \"/\";\n\n  const [loginError, setLoginError] = useState(\"\");\n\n  const handleLogin = (data) => {\n    setLoginError(\"\");\n    console.log(data);\n    emailSignIn(data.email, data.password)\n      .then((userCredentials) => {\n        const user = userCredentials.user;\n        console.log(user);\n        //jwt token\n        fetch(`https://ark-deals-server.vercel.app/jwt?email=${user?.email}`)\n          .then((res) => res.json())\n          .then((data) => {\n            console.log(data.accessToken);\n            localStorage.setItem(\"arkDeals\", data.accessToken);\n            toast.success(\"Login SuccessFully!\");\n            navigate(from, { replace: true });\n          });\n      })\n      .catch((err) => {\n        setLoginError(err.message);\n        isLoading(false);\n      });\n  };\n\n  const handleGoogleSign = () => {\n    googleSign()\n      .then((res) => {\n        const signedUser = res.user;\n        console.log(signedUser);\n        const user = {\n          name: signedUser.displayName,\n          email: signedUser.email,\n          role: \"buyer\",\n        };\n        fetch(`https://ark-deals-server.vercel.app/add-users`, {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/json\",\n          },\n          body: JSON.stringify(user),\n        })\n          .then((res) => res.json())\n          .then((data) => {\n            if (data.acknowledged) {\n              //jwt token\n              fetch(\n                `https://ark-deals-server.vercel.app/jwt?email=${user?.email}`\n              )\n                .then((res) => res.json())\n                .then((data) => {\n                  console.log(data.accessToken);\n                  localStorage.setItem(\"arkDeals\", data.accessToken);\n                  toast.success(\"Registration Success as Buyer!\");\n                  navigate(\"/\");\n                });\n            }\n          });\n      })\n      .catch((err) => {\n        setLoginError(err.message);\n        isLoading(false);\n      });\n  };\n\n  return (\n    <div className=\"hero min-h-screen bg-base-200\">\n      <div className=\"hero-content flex-col lg:flex-row\">\n        <div className=\"text-center lg:text-left\">\n          <h1 className=\"text-5xl font-bold\">Login now!</h1>\n          <p className=\"py-6\">\n            Get the best deals for your preferred laptop with the best price\n          </p>\n        </div>\n        <div className=\"card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100\">\n          <div className=\"card-body\">\n            <form onSubmit={handleSubmit(handleLogin)}>\n              <h2 className=\"text-2xl text-center\">Login</h2>\n              <div className=\"form-control w-full max-w-xs\">\n                <label className=\"label\">\n                  {\" \"}\n                  <span className=\"label-text\">Email</span>\n                </label>\n                <input\n                  type=\"text\"\n                  {...register(\"email\", {\n                    required: \"Email Address is required\",\n                  })}\n                  className=\"input input-bordered w-full max-w-xs\"\n                />\n                {errors.email && (\n                  <p className=\"text-red-600\">{errors.email?.message}</p>\n                )}\n              </div>\n              <div className=\"form-control w-full max-w-xs\">\n                <label className=\"label\">\n                  {\" \"}\n                  <span className=\"label-text\">Password</span>\n                </label>\n                <input\n                  type=\"password\"\n                  {...register(\"password\", {\n                    required: \"Password is required\",\n                    minLength: {\n                      value: 6,\n                      message: \"Password must be 6 characters or longer\",\n                    },\n                  })}\n                  className=\"input input-bordered w-full max-w-xs\"\n                />\n                <label className=\"label\">\n                  {\" \"}\n                  <span className=\"label-text\">Forget Password?</span>\n                </label>\n                {errors.password && (\n                  <p className=\"text-red-600\">{errors.password?.message}</p>\n                )}\n              </div>\n              <input\n                className=\"btn btn-accent w-full\"\n                value=\"Login\"\n                type=\"submit\"\n              />\n              <div>\n                {loginError && <p className=\"text-red-600\">{loginError}</p>}\n              </div>\n            </form>\n            <p className=\"text-sm\">\n              New to arkDEALS.com?{\" \"}\n              <Link className=\"text-secondary\" to=\"/register\">\n                Register as Buyer\n              </Link>\n            </p>\n            <div className=\"divider\">OR</div>\n            <button\n              onClick={handleGoogleSign}\n              className=\"btn btn-outline btn-secondary w-full\"\n            >\n              CONTINUE WITH GOOGLE\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}