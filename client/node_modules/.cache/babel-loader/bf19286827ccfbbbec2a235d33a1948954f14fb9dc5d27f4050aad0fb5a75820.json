{"ast":null,"code":"import _slicedToArray from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useQuery}from'@tanstack/react-query';import React,{useState}from'react';import{toast}from'react-toastify';import AllbuyerTable from'../../../Components/AllbuyerTable';import ConfirmationModal from'../../../Components/ConfirmationModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Allbuyer=function Allbuyer(){var _useQuery=useQuery({queryKey:['buyers'],queryFn:function(){var _queryFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://localhost:5001/allbuyers\",{headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}},_callee);}));function queryFn(){return _queryFn.apply(this,arguments);}return queryFn;}()}),_useQuery$data=_useQuery.data,buyers=_useQuery$data===void 0?[]:_useQuery$data,refetch=_useQuery.refetch;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),deletingBuyer=_useState2[0],setDeletingBuyer=_useState2[1];var confirmationModal=function confirmationModal(user){setDeletingBuyer(user);};var closeModal=function closeModal(){setDeletingBuyer(null);};var handleDelete=function handleDelete(user){console.log(user);fetch(\"http://localhost:5001/buyer-orders-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);fetch(\"http://localhost:5001/user-delete/\".concat(user===null||user===void 0?void 0:user.email),{method:'DELETE',headers:{authorization:\"Bearer \".concat(localStorage.getItem('arkDeals'))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();toast.success(\"User has been deleted successfully\");toast.warn(\"Don't forget to delete this user from Firebase!\");});});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-base-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-xl\",children:\"All Buyer\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto w-full\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table w-full \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"Seller Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:buyers.map(function(buyer,i){return/*#__PURE__*/_jsx(AllbuyerTable,{buyer:buyer,confirmationModal:confirmationModal,i:i},buyer._id);})})]})})]}),deletingBuyer&&/*#__PURE__*/_jsx(ConfirmationModal,{title:\"Your are deleting \".concat(deletingBuyer.name),message:\"Everything associated with this email: \".concat(deletingBuyer.name,\"  will be deleted from database. \\n          Since your are using firebase authentication, you must delete \").concat(deletingBuyer.email,\" from there manually!\"),successAction:handleDelete,successButtonName:\"Delete\",modalData:deletingBuyer,closeModal:closeModal})]});};export default Allbuyer;","map":{"version":3,"names":["useQuery","React","useState","toast","AllbuyerTable","ConfirmationModal","Allbuyer","queryKey","queryFn","fetch","headers","authorization","localStorage","getItem","res","json","data","buyers","refetch","deletingBuyer","setDeletingBuyer","confirmationModal","user","closeModal","handleDelete","console","log","email","method","then","success","warn","map","buyer","i","_id","name"],"sources":["/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/src/Pages/Dashboard/Admin/Allbuyer.jsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\nimport React, { useState } from 'react';\nimport { toast } from 'react-toastify';\nimport AllbuyerTable from '../../../Components/AllbuyerTable';\nimport ConfirmationModal from '../../../Components/ConfirmationModal';\n\nconst Allbuyer = () => {\n    const { data: buyers = [], refetch } = useQuery({\n        queryKey: ['buyers'],\n        queryFn: async () => {\n            const res = await fetch(`http://localhost:5001/allbuyers`, {\n                headers: {\n                    authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n                }\n            })\n            const data = await res.json();\n            return data\n        }\n    })\n\n    const [deletingBuyer, setDeletingBuyer] = useState(null);\n\n    const confirmationModal = user => {\n        setDeletingBuyer(user)\n    }\n    const closeModal = () => {\n        setDeletingBuyer(null)\n    }\n\n    const handleDelete = (user) => {\n        console.log(user);\n        fetch(`http://localhost:5001/buyer-orders-delete/${user?.email}`, {\n            method: 'DELETE',\n            headers: {\n                authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n            }\n        })\n            .then(res => res.json())\n            .then(data => {\n                console.log(data)\n                fetch(`http://localhost:5001/user-delete/${user?.email}`, {\n                    method: 'DELETE',\n                    headers: {\n                        authorization: `Bearer ${localStorage.getItem('arkDeals')}`\n                    }\n                })\n                    .then(res => res.json())\n                    .then(data => {\n                        console.log(data)\n                        refetch();\n                        toast.success(\"User has been deleted successfully\");\n                        toast.warn(\"Don't forget to delete this user from Firebase!\")\n                        \n                })\n        })\n    }\n\n    return (\n        <div>\n      <div className=\"bg-base-100\">\n        <h2 className=\"text-center text-xl\">All Buyer</h2>\n        <div className=\"overflow-x-auto w-full\">\n          <table className=\"table w-full \">\n            <thead>\n              <tr>\n                <th></th>\n                <th>Seller Name</th>\n                <th>Email</th>\n                \n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n            {buyers.map((buyer,i) =><AllbuyerTable key={buyer._id} buyer={buyer} confirmationModal={confirmationModal} i={i} ></AllbuyerTable>)}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      {deletingBuyer && (\n        <ConfirmationModal\n          title={`Your are deleting ${deletingBuyer.name}`}\n                    message={`Everything associated with this email: ${deletingBuyer.name}  will be deleted from database. \n          Since your are using firebase authentication, you must delete ${deletingBuyer.email} from there manually!`}\n          successAction={handleDelete}\n          successButtonName=\"Delete\"\n          modalData={deletingBuyer}\n          closeModal={closeModal}\n        ></ConfirmationModal>\n      )}\n    </div>\n    );\n};\n\nexport default Allbuyer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}