{"ast":null,"code":"import _regeneratorRuntime from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useQuery}from\"@tanstack/react-query\";import React,{useContext,useState}from\"react\";import{toast}from\"react-toastify\";import ConfirmationModal from\"../../../Components/ConfirmationModal\";import MybuyersTable from\"../../../Components/MybuyersTable\";import{AuthContext}from\"../../../Context/AuthProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MyBuyers=function MyBuyers(){var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),meetingOrder=_useState2[0],setMeetingOrder=_useState2[1];var _useQuery=useQuery({queryKey:[\"orders\"],queryFn:function(){var _queryFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://ark-deals-server.vercel.app/mybuyers?email=\".concat(user===null||user===void 0?void 0:user.email),{headers:{authorization:\"bearer \".concat(localStorage.getItem(\"arkDeals\"))}});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}},_callee);}));function queryFn(){return _queryFn.apply(this,arguments);}return queryFn;}()}),_useQuery$data=_useQuery.data,orders=_useQuery$data===void 0?[]:_useQuery$data,refetch=_useQuery.refetch;console.log(orders);var confirmationModal=function confirmationModal(order){setMeetingOrder(order);};var closeModal=function closeModal(){setMeetingOrder(null);};var handleMeet=function handleMeet(order){console.log(order);console.log(order.meeting);fetch(\"https://ark-deals-server.vercel.app/confirm-meeting/\".concat(order._id),{method:\"PATCH\",headers:{authorization:\"bearer \".concat(localStorage.getItem(\"arkDeals\"))}}).then(function(res){return res.json();}).then(function(data){console.log(data);refetch();if(order.meeting===true){toast.warn(\"Meeting is marked as Canceled!\");}else{toast.success(\"Meeting is marked as Done!\");}});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-base-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-xl\",children:\"My Orders\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto w-full\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table w-full \",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:\"Laptop\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Buyer Details\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Location\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order,i){return/*#__PURE__*/_jsx(MybuyersTable,{order:order,confirmationModal:confirmationModal,i:i,handleMeet:handleMeet},order._id);})})]})})]}),meetingOrder&&/*#__PURE__*/_jsx(ConfirmationModal,{title:\"Meeting for \".concat(meetingOrder.product.productName,\" with \").concat(meetingOrder.buyerName),message:\"You are confirming that you had a meeting with \".concat(meetingOrder.buyerName,\" and you're letting \").concat(meetingOrder.buyerName,\" to pay $\").concat(meetingOrder.product.resalePrice,\" \"),successAction:handleMeet,successButtonName:\"Confirm\",modalData:meetingOrder,closeModal:closeModal})]});};export default MyBuyers;","map":{"version":3,"names":["useQuery","React","useContext","useState","toast","ConfirmationModal","MybuyersTable","AuthContext","MyBuyers","user","meetingOrder","setMeetingOrder","queryKey","queryFn","fetch","email","headers","authorization","localStorage","getItem","res","json","data","orders","refetch","console","log","confirmationModal","order","closeModal","handleMeet","meeting","_id","method","then","warn","success","map","i","product","productName","buyerName","resalePrice"],"sources":["/Users/abdurrahman/VsCode/WebDev/PGHERO/MileStone12/ark-deals-client/src/Pages/Dashboard/Seller/MyBuyers.jsx"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport React, { useContext, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport ConfirmationModal from \"../../../Components/ConfirmationModal\";\nimport MybuyersTable from \"../../../Components/MybuyersTable\";\nimport { AuthContext } from \"../../../Context/AuthProvider\";\n\nconst MyBuyers = () => {\n  const { user } = useContext(AuthContext);\n  const [meetingOrder, setMeetingOrder] = useState(null);\n  const { data: orders = [], refetch } = useQuery({\n    queryKey: [\"orders\"],\n    queryFn: async () => {\n      const res = await fetch(\n        `https://ark-deals-server.vercel.app/mybuyers?email=${user?.email}`,\n        {\n          headers: {\n            authorization: `bearer ${localStorage.getItem(\"arkDeals\")}`,\n          },\n        }\n      );\n      const data = await res.json();\n      return data;\n    },\n  });\n  console.log(orders);\n\n  const confirmationModal = (order) => {\n    setMeetingOrder(order);\n  };\n  const closeModal = () => {\n    setMeetingOrder(null);\n  };\n\n  const handleMeet = (order) => {\n    console.log(order);\n    console.log(order.meeting);\n    fetch(`https://ark-deals-server.vercel.app/confirm-meeting/${order._id}`, {\n      method: \"PATCH\",\n      headers: {\n        authorization: `bearer ${localStorage.getItem(\"arkDeals\")}`,\n      },\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        refetch();\n        if (order.meeting === true) {\n          toast.warn(\"Meeting is marked as Canceled!\");\n        } else {\n          toast.success(\"Meeting is marked as Done!\");\n        }\n      });\n  };\n\n  return (\n    <div>\n      <div className=\"bg-base-100\">\n        <h2 className=\"text-center text-xl\">My Orders</h2>\n        <div className=\"overflow-x-auto w-full\">\n          <table className=\"table w-full \">\n            <thead>\n              <tr>\n                <th></th>\n                <th>Laptop</th>\n                <th>Buyer Details</th>\n                <th>Price</th>\n                <th>Location</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.map((order, i) => (\n                <MybuyersTable\n                  key={order._id}\n                  order={order}\n                  confirmationModal={confirmationModal}\n                  i={i}\n                  handleMeet={handleMeet}\n                ></MybuyersTable>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      {meetingOrder && (\n        <ConfirmationModal\n          title={`Meeting for ${meetingOrder.product.productName} with ${meetingOrder.buyerName}`}\n          message={`You are confirming that you had a meeting with ${meetingOrder.buyerName} and you're letting ${meetingOrder.buyerName} to pay $${meetingOrder.product.resalePrice} `}\n          successAction={handleMeet}\n          successButtonName=\"Confirm\"\n          modalData={meetingOrder}\n          closeModal={closeModal}\n        ></ConfirmationModal>\n      )}\n    </div>\n  );\n};\n\nexport default MyBuyers;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}